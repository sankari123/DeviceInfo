<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title></title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width">
        <script type="text/javascript" src="cordova.js"></script>
    <script>
   
    document.addEventListener("deviceready", init, false);
function init() {
 $('#startWatch').trigger('click');
  app.checkSMSPermission();
 
}

	  
	    
	    
 var app = {
    checkSMSPermission: function() {
        var success = function (hasPermission) { 
            if (hasPermission) {
               // sms.send(...);
		     app.checkSMSPermission();
            }
            else {
                // show a helpful message to explain why you need to require the permission to send a SMS
                // read http://developer.android.com/training/permissions/requesting.html#explain for more best practices
            }
        };
        var error = function (e) { alert('Something went wrong:' + e); };
        sms.hasPermission(success, error);
    },
    requestSMSPermission: function() {
        var success = function (hasPermission) { 
            if (!hasPermission) {
                sms.requestPermission(function() {
                    console.log('[OK] Permission accepted')
                }, function(error) {
                    console.info('[WARN] Permission not accepted')
                    // Handle permission not accepted
                })
            }
        };
        var error = function (e) { alert('Something went wrong:' + e); };
        sms.hasPermission(success, error);
	
    }
};
	    
  
	    
	    
   function onConfirm(buttonIndex) {
      // alert('You selected button ' + buttonIndex);
   if(buttonIndex==1){ 
	var hideKeyboard = function() {
    	    document.activeElement.blur();
    	    $("input").blur();
	};
	   
        app.sendSms(); 
navigator.notification.confirm('Want to upload your display photo', onDPUpload,  'Upload',   ['OK','Cancel']       );
    }
	   else 
    {
         document.getElementById("numberTxt").focus();
    }
	 
	   
	   
 	
		   
   }
 
	    
 function cnfmTest()
  {
          var number1= document.getElementById('numberTxt').value.toString(); /* iOS: ensure number is actually a string */
   	  
	  msg1="Do you want to send SMS to " + number1;
	 
	 navigator.notification.confirm(msg1, onConfirm,  'Send SMS',   ['OK','Cancel']       );
	 // alert('inside');
 }
	    
	    
var app = {
    sendSms: function() {
  var number = document.getElementById('numberTxt').value.toString(); /* iOS: ensure number is actually a string */
   var message = document.getElementById('messageTxt').value;
        //CONFIGURATION
	    
        var options = {
            replaceLineBreaks: false, // true to replace \n by a new line, false by default
            android: {
                   intent: 'INTENT'  // send SMS with the native android SMS messaging
      		// intent: '' // send SMS without opening any other app
            }
        };

        var success = function () { alert('Starting.....!'); };
	var success1 = function () {  alert('Authentication Successful... Welcome to ownApp!');   };
        var error = function (e) { alert('Message Failed:' + e); };
        sms.send(number, message, options, success1, error);
	   
	  //  setTimeout(myFunction, 3000)
	    //    $('#stopWatch').trigger('click');
	    
	 setTimeout(function(){

        $("#stopWatch").click();
  	  },2000);
	     alert('Authentication in progress.!');
    }
	
};


 document.addEventListener('onSMSArrive', function(e) {
    console.log('onSMSArrive()');
    var IncomingSMS = e.data;
    console.log('sms.address:' + IncomingSMS.address);
    console.log('sms.body:' + IncomingSMS.body);
    /* Debug received SMS content (JSON) */
    console.log(JSON.stringify(IncomingSMS));

});
	    
	    
SMSReceive.startWatch(function() {
    console.log('smsreceive: watching started');
	//alert('in');
}, function() {
    console.warn('smsreceive: failed to start watching');
	//alert('out');
});
	    
	    
  SMSReceive.stopWatch(function() {
    console.log('smsreceive: watching stopped');
}, function() {
    console.warn('smsreceive: failed to stop watching');
});
			    
	function onDPUpload(buttonIndex)
	    {
	      if(buttonIndex==1)
	      {
		   
		   navigator.camera.getPicture(onSuccess, onFail, { quality: 50,destinationType: Camera.DestinationType.FILE_URI,sourceType: sourceType: Camera.PictureSourceType.PHOTOLIBRARY });
	      }
		    else 
		    {
		    }
	    }
 

	    function onSuccess(imageData) {
		    document.getElementById("imgDP").style.display = "block";
   		    document.getElementById("imgDP").style.visibility="visible";
                var image = document.getElementById('img');
                image.src = imageData + '?' + Math.random();;
            }

            function onFail(message) {
                alert('Failed because: ' + message);
            }
	    
	   
   	    
	    
	    
		</script>
	<style>
	#messageTxt
        {
            display:none;
        }
	#startWatch
	{
            display:none;
        }
	#stopWatch
	{
            display:none;
        }
	#scr_1
        {
           /* display:none;*/
		max-width: 400px;
   		width: 100% !important;
		font-family: 'Open Sans', sans-serif;
		font-size: 13px;
        }
		#btn2 {background-color: #e15f5f; border:none; padding: 0; font-weight: bold; color: white;font-size: 15px;}
#numberTxt{
	
	background: transparent;
    border: none;
    border-bottom: 1px solid #000000;
		}
		
		#imgDP
        {
           display:none; 
		
		}		
	</style>
	</head>
	<body>
 <div id='scr_1'>
	 <table border='0' align='center' width='100%'><tr height='10%' ><td align='center'>Verify Phone Number </td></tr>
		 		 <tr><td>&nbsp;</td></tr>
	
		 
	 <tr><td align='center'><input id="numberTxt" placeholder="Enter mobile number" type="tel" />&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='btn2' onclick="cnfmTest();" value="Verify" /></td></tr>
	 <tr><td><input id="messageTxt" placeholder="Enter message" value='Verification Code from OwnApp:ST54sdHGSJ76' /></td></tr>
		  <tr><td align='center'>OwnAPP wil send SMS to verify your number. </td></tr>
			  
			  <tr><td align='center'><font size=1>SMS charges may apply.</font></td></tr>
	<!-- <tr><td align='center'><input type="button" id='btn2' onclick="app.sendSms();" value="Send SMS" /></td></tr>-->
	 </table>
	</div>
		<!--<input id="numberTxt" placeholder="Enter mobile number" value="9940240074" type="tel" />
		<input id="messageTxt" placeholder="Enter message" value='testing 123sdfsdfsdfsdfsd' />
	 	<input type="button" onclick="app.sendSms();" value="Send SMS" />	--> 
		<input type="button" id="startWatch" onclick="SMSReceive.startWatch()" value='start'   /> 
		<input type="button" id="stopWatch" onclick="SMSReceive.stopWatch();" value='stop'   /> 
		
<div id='imgDP'>
            <img src="img/cam2.jpg" id='img' style="width: 100px; height: 100px;">
        </div>
	
	</body>	
	</html>
